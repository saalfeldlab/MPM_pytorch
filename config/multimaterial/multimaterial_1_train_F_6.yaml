description: '9 discs of different materials falling down in a box  size 128 LR 1E-7 batch 16'
dataset: 'multimaterial_1'

simulation:
  params: [[0, 0.2, 0.4, 0.6, 0.8], [0.2, 0.2, 0.2, 0.2, 0.2]]
  min_radius: 0
  max_radius: 0.0125
  n_particles: 9000
  n_grid: 128
  n_particle_types: 3
  n_frames: 2000
  delta_t: 7.5E-5
  dpos_init: 1.0
  boundary: 'no'
  start_frame: 0

  MPM_expansion_factor: 1.0
  MPM_n_objects: 9
  MPM_object_type: 'discs'
  MPM_gravity: -50
  MPM_rho_list: [ 1.0, 0.5, 0.25 ]
  MPM_friction: 0.0
  MPM_young_coeff: 1.0

graph_model:
  particle_model_name: 'PDE_MPM'
  mesh_model_name: ''
  prediction: '2nd_derivative'

  aggr_type: 'add'
  embedding_dim: 2

  # UPDATED: MLP configuration through multi_mlp_params
  # Format: [input_size, output_size, n_layers, hidden_size, initialisation]
  # Order: [mu_lambda, sig, F, stress]
  multi_mlp_params: [
      [3, 2, 3, 32, "normal"],      # MLP_mu_lambda [0]
      [4, 2, 5, 32, "ones"],        # MLP_sig [1]
      [15, 4, 5, 128, "normal"],    # MLP_F [2]
      [11, 4, 5, 128, "normal"]     # MLP_stress [3]
  ]

  # UPDATED: Siren configuration through multi_siren_params
  # Format: [in_features, out_features, hidden_features, hidden_layers, first_omega_0, hidden_omega_0, outermost_linear]
  # Order: [F, Jp, C_normal, C_PDE_MPM_A]
  multi_siren_params: [
      [3, 4, 128, 3, 128.0, 128.0, True],    # siren_F [0]
      [3, 1, 128, 3, 128.0, 128.0, True],    # siren_Jp [1]
      [5, 4, 128, 3, 128.0, 128.0, True],    # siren_C normal [2]
      [7, 4, 128, 3, 128.0, 128.0, True]     # siren_C PDE_MPM_A [3]
  ]



plotting:
  colormap: 'tab10'
  arrow_length: 2
  ylim: [-0.001, 0]

training:

  device: 'auto'
  n_runs: 1
  n_epochs: 6

  batch_size: 16
  
  small_init_batch_size: False

  noise_model_level: 0

  sparsity: 'none'
  data_augmentation_loop: 50

  learning_rate_start: 1E-5
  learning_rate_embedding_start: 1E-2
  learning_rate_NNR: 1E-7

  coeff_F_norm: 0
  coeff_det_F: 1

  MPM_trainer : 'F'







